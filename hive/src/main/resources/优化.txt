1. 在编写带有 join 操作的代码语句时，应该将条目少的表/子查询放在 Join 操作符的左边。
因为在 Reduce 阶段，位于 Join 操作符左边的表的内容会被加载进内存，载入条目较少的表 可以有效减少 OOM（out of memory）即内存溢出。
2. 合并小文件
我们知道文件数目小，容易在文件存储端造成瓶颈，给 HDFS 带来压力，影响处理效率。对此，可以通过合并Map和Reduce的结果文件来消除这样的影响。
用于设置合并属性的参数有：
是否合并Map输出文件：hive.merge.mapfiles=true（默认值为真）
是否合并Reduce 端输出文件：hive.merge.mapredfiles=false（默认值为假）
合并文件的大小：hive.merge.size.per.task=256*1000*1000（默认值为 256000000）
3. 解决数据倾斜
原因：key分布不均匀，key空值太多，导致少量reduce处理时间过长
参数调节：hive.map.aggr=true Map端部分聚合，相当于Combiner
sql语句调节：空值处理（过滤掉或者随机值）
采用sum() group by的方式来替换count(distinct)完成计算。